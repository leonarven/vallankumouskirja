{"version":3,"sources":["../src/worker.js"],"names":[],"mappings":"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","file":"worker.js","sourcesContent":["LaulukirjaApp.config(function($stateProvider, $urlRouterProvider){\n\t$urlRouterProvider.otherwise(\"/index\");\n\t$stateProvider.state(\"index\", {\n\t\turl        : \"/index\",\n\t\tviews : {\n\t\t\t\"songsList@\" : {\n\t\t\t\tcontroller  : \"songListController\",\n\t\t\t\ttemplateUrl : \"partials/songlist.html\"\n\t\t\t}\n\t\t},\n\t\tresolve : {\n\t\t\t\"songsIndex\" : [\"$rootScope\", \"$http\", function($rootScope, $http){\n\t\t\t\treturn $http({\n\t\t\t\t\turl    : \"songs/index.json\",\n\t\t\t\t\tmethod : \"GET\"\n\t\t\t\t}).then(function(response){\n\t\t\t\t\tvar songsIndex = response.data;\n\t\t\t\t\tfor(var key in songsIndex) {\n\t\t\t\t\t\tif (songsIndex[key].disabled) {\n\t\t\t\t\t\t\tdelete songsIndex[key];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tsongsIndex[key].key = key;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t$rootScope.songsArr = Object.keys(songsIndex);\n\t\t\t\t\t$rootScope.songsArr.sort(function(a, b){\n\t\t\t\t\t\treturn songsIndex[a].num - songsIndex[b].num;\n\t\t\t\t\t});\n\t\t\t\t\treturn $rootScope.songsIndex = songsIndex;\n\t\t\t\t}).catch(console.error.bind(console, \"Cannot GET 'songs/index.json'\"));\n\t\t\t}]\n\t\t}\n\t}).state(\"index.song\", {\n\t\turl   : \"/:song_key\",\n\t\tviews : {\n\t\t\t\"songView@\" : {\n\t\t\t\tcontroller  : \"songViewController\",\n\t\t\t\ttemplateUrl : \"partials/songview.html\"\n\t\t\t},\n\t\t\t\"songMeta@\" : {\n\t\t\t\tcontroller  : \"songMetaController\",\n\t\t\t\ttemplateUrl : \"partials/songmeta.html\"\n\t\t\t}\n\t\t},\n\t\tresolve : {\n\t\t\t\"$songMeta\" : [\"$rootScope\", \"$http\", \"$stateParams\", \"$state\", \"songsIndex\", function($rootScope, $http, $stateParams, $state, songsIndex){\n\t\t\t\tif (!songsIndex[$stateParams.song_key]) {\n\t\t\t\t\tconsole.error(\"Could not found song '\"+ $stateParams.song_key +\"'\");\n\t\t\t\t\t$state.go(\"index\");\n\t\t\t\t}\n\t\t\t\treturn songsIndex[$stateParams.song_key];\n\t\t\t}],\n\t\t\t\"$songBody\" : [\"$rootScope\", \"$http\", \"$stateParams\", \"$state\", \"$songMeta\", function($rootScope, $http, $stateParams, $state, $songMeta){\n\t\t\t\treturn $http({\n\t\t\t\t\turl    : \"songs/\"+ $songMeta.key +\"/song.html\",\n\t\t\t\t\tmethod : \"GET\"\n\t\t\t\t}).then(function(response){\n\t\t\t\t\t$rootScope.$songMeta = $songMeta;\n\t\t\t\t\treturn response.data;\n\t\t\t\t}).catch(function(){\n\t\t\t\t\tconsole.error(\"Could not GET 'songs/\"+ $songMeta.key +\"/song.html'\");\n\t\t\t\t\t$state.go(\"index\");\n\t\t\t\t});\n\t\t\t}]\n\t\t}\n\t})\n});\nLaulukirjaApp.run([\"$rootScope\", \"Notification\", \"$state\", function($rootScope, Notification, $state) {\n\t$rootScope.$state = $state;\n\t$rootScope.songsIndex = {};\n\t$rootScope.font_size = 12;\n\t$rootScope.setSongFont = function(n){ $rootScope.font_size += n; };\n\t$rootScope.increaseFont = function(n){ $rootScope.font_size *= 1.1; };\n\t$rootScope.decreaseFont = function(n){ $rootScope.font_size *= 0.9; };\n\t$rootScope.songlist = {\n\t\topen : true\n\t};\n\n\twindow.addEventListener(\"resize\", $rootScope.$emit.bind( $rootScope, \"resize\" ));\n\n\t$rootScope.$on('$stateChangeStart',function(event, toState, toParams, fromState, fromParams, _options) {\n\t\ttry {\n\t\t\tif (toState.name == \"index\")\n\t\t\t\t$rootScope.$songMeta = null;\n\t\t} catch(err) {\n\t\t\tconsole.error(err);\n\t\t\tevent.preventDefault();\n\t\t}\n\t});\n\n\t$rootScope.$on('$stateChangeError',function(event, toState, toParams, fromState, fromParams){\n\t\tNotification.error('$stateChangeError @ '+toState.name);\n\t\tconsole.error('$stateChangeError @ '+toState.to, arguments);\n\t});\n\n\t$rootScope.$on('$stateChangeSuccess',function(event, toState, toParams, fromState, fromParams){\n\t\tconsole.log('$stateChangeSuccess @ '+toState.to, arguments);\n\t\tif (toState.name == 'index') $rootScope.songlist.open = true;\n\t\telse if (toState.name == 'index.song') {\n\t\t\tif (window.innerWidth <= 768) $rootScope.songlist.open = false;\n\t\t}\n\t\tangular.element(document.body).attr(\"state\", toState.name);\n\t});\n\n\t$rootScope.$on('$viewContentLoaded',function(event){\n\t\tconsole.log('$viewContentLoaded', arguments);\n\t});\n\n\t$rootScope.$on('$stateNotFound',function(event, unfoundState, fromState, fromParams){\n\t\tif (!!unfoundState.to) Notification.error('$stateNotFound @ '+unfoundState.to);\n\t\tconsole.error('$stateNotFound @ '+unfoundState.to, arguments);\n\t});\n}]);\n\nLaulukirjaApp.controller(\"songListController\", [\"$rootScope\", \"$scope\", \"$stateParams\", \"songsIndex\", function($rootScope, $scope, $stateParams, songsIndex){\n\t$scope.$stateParams = $stateParams;\n\tconsole.log(songsIndex);\n}]);\nLaulukirjaApp.controller(\"songViewController\", [\"$rootScope\", \"$scope\", \"$sce\", \"songsIndex\", \"$songMeta\", \"$songBody\", \"$timeout\", function( $rootScope, $scope, $sce, songsIndex, $songMeta, $songBody, $timeout ) {\n\tvar scrollStalker;\n\n\t$scope.$songMeta = $songMeta;\n\t$scope.$songBody = $songBody;\n\n\tvar songBodyElem = document.getElementById(\"song-body\");\n\tsongBodyElem.innerHTML = $songBody;\n\n\t$rootScope.$on( \"resize\", refreshFont );\n\n\t$scope.loading = refreshFont().then(function(){\n\t\t$scope.loading = false;\n\t});\n\n\tfunction refreshFont() {\n\t\treturn $timeout(function(){\n\t\t\tvar pre = document.getElementById( \"song-body\" );\n\t\t\tvar prs = pre.parentNode.offsetWidth / pre.offsetWidth;\n\t\t\tif (prs > 0) $rootScope.font_size *= prs;\n\t\t\tconsole.log( \"refreshFont() :: \", $rootScope.font_size, \"em\" );\n\t\t}).catch(function( e ){\n\t\t\tconsole.warn( \"Unable to customize font size\", e );\n\t\t});\n\t}\n}]);\nLaulukirjaApp.controller(\"songMetaController\", [\"$rootScope\", \"$scope\", \"songsIndex\", \"$songBody\", \"$songMeta\", function($rootScope, $scope, songsIndex, $songBody, $songMeta) {\n//\tconsole.log(songsIndex, $songBody, $songMeta);\n\t$scope.meta = {\n\t\ttitle  : $songMeta.title,\n\t\tauthor : $songMeta.author || null,\n\t\tlinks  : $songMeta.links  || {},\n\t}\n\tfor(var title in $scope.meta.links) {\n\t\t$scope.meta.links[title] = {\n\t\t\ttitle : title,\n\t\t\thref  : $scope.meta.links[title]\n\t\t};\n\t}\n}]);\n\n\nLaulukirjaApp.component(\"a_songList\", {\n\ttemplate : \"partials/songlist.html\",\n\tcontroller : [\"$scope\", \"$rootScope\", function($scope, $rootScope){\n\t\tconsole.log($rootScope.songsIndex);\n\t}]\n})\n"]}