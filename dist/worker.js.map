{"version":3,"sources":["../src/worker.js"],"names":[],"mappings":"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","file":"worker.js","sourcesContent":["(() => {\n\tclass Song {\n\t\tconstructor( key, data ) {\n\t\t\tthis.key = key;\n\t\t\tfor (var v in data) this[ v ] = data[ v ];\n\n\t\t\tthis.$templateUrl = `songs/${ key }/song.html`;\n\n\t\t\tthis.$search = new SearchString({\n\t\t\t\ttitle : data.title || \"\",\n\t\t\t\tnum   : data.num == null ? \"\" : data.num.toString().trim()\n\t\t\t});\n\t\t}\n\t}\n\n\tclass SearchString{\n\t\tconstructor( argv ){\n\t\t\tthis.$string   = \"\";\n\t\t\tthis.$contains = {}\n\n\t\t\targv && this.extend( argv );\n\t\t}\n\n\t\textend( argv ){\n\t\t\tvar str = null;\n\t\t\tif (typeof argv == \"object\") {\n\t\t\t\tstr = \"\";\n\t\t\t\tfor (var key in argv) {\n\t\t\t\t\tif (argv[ key ] != null) {\n\t\t\t\t\t\targv[ key ] = SearchString.filterString2searchKey( argv[ key ]);\n\t\t\t\t\t\tthis.$contains[ key ] = (this.$contains[ key ] || \"\") + \" \" + argv[ key ];\n\t\t\t\t\t\tstr += \" \" + argv[ key ];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (typeof argv == \"string\" && argv.trim().length > 0 ){\n\t\t\t\tstr = argv;\n\t\t\t}\n\n\t\t\tif (typeof str == \"string\") {\n\t\t\t\tthis.$string = SearchString.filterString2searchKey( this.$string, str );\n\t\t\t} else if (argv) {\n\t\t\t\tconsole.warn( \"SearchString.extend :: Invalid argument\" );\n\t\t\t}\n\t\t}\n\n\t\ttoString() {\n\t\t\treturn this.$string;\n\t\t}\n\t}\n\n\tSearchString.filterString2searchKey = (function(){\n\t\tvar regexp_torm  = /[\\.,:'\\(\\)\\[\\]\\{\\}\\/\\\\]/g;  // Poistettavat (whitespacella korvattavat) merkit\n\t\tvar regexp_toosm = /\\s.{0,3}\\s/g;                 // Liian lyhyet whitespacen ympäröimät merkkijonot ( 0-3 merkkiä) (myös whitespacen, (2-5 merkkiä))\n\n\t\treturn function( str ) {\n\t\t\tif (arguments.length > 1) return SearchString.filterString2searchKey( Array.prototype.slice.call( arguments ));\n\t\t\tif (Array.isArray( str )) str = parseArray2string( str );\n\t\t\tif (typeof str != \"string\") return console.warn( \"SearchString.filterString2searchkey :: Invalid argument\", typeof str, str ), \"\";\n\n\t\t\treturn (\" \" + str.toLowerCase().replace( regexp_torm, \" \" ) + \" \").replace( regexp_toosm, \" \" ).trim();\n\t\t};\n\n\t\tfunction parseArray2string( arr ){\n\t\t\treturn arr.filter(function( v ) {\n\t\t\t\treturn !!v;\n\t\t\t}).map(function( v ) {\n\t\t\t\treturn Array.isArray( v ) ? parseArray2string( v ) : v;\n\t\t\t}).join(\" \");\n\t\t}\n\t})();\n\n\t/************************************************************/\n\n\tangular.module(\"laulukirja-app\", [ \"ui.router\" ])\n\n\t.config([ \"$stateProvider\", \"$urlRouterProvider\", function($stateProvider, $urlRouterProvider){\n\t\t$urlRouterProvider.otherwise(\"/index\");\n\t\t$stateProvider.state(\"index\", {\n\t\t\turl        : \"/index\",\n\t\t\tviews : {\n\t\t\t\t\"songsList@\" : {\n\t\t\t\t\tcontroller  : \"songListController\",\n\t\t\t\t\ttemplateUrl : \"partials/songlist.html\"\n\t\t\t\t},\n\t\t\t\t\"songView@\" : {\n\t\t\t\t\tcontroller : [ \"$scope\", \"$timeout\", function( $scope, $timeout ){ $scope.loading = $timeout(()=>{ $scope.loading = false; }); }],\n\t\t\t\t\ttemplate: \"<h3 style='text-align:left;padding-left:1em;'><b class='glyphicon glyphicon-share-alt' style='transform:rotate(230deg);'></b> Valitse laulu laululistasta</h3>\"\n\t\t\t\t}\n\t\t\t},\n\t\t\tresolve : {\n\t\t\t\t\"songsIndex\" : [ \"Songs\", Songs => Songs.init( \"songs/index.json\" ) ]\n\t\t\t}\n\t\t}).state(\"index.song\", {\n\t\t\turl   : \"/:song_key\",\n\t\t\tviews : {\n\t\t\t\t\"songView@\" : {\n\t\t\t\t\tcontroller  : \"songViewController\",\n\t\t\t\t\ttemplateUrl : \"partials/songview.html\"\n\t\t\t\t},\n\t\t\t\t\"songMeta@\" : {\n\t\t\t\t\tcontroller  : \"songMetaController\",\n\t\t\t\t\ttemplateUrl : \"partials/songmeta.html\"\n\t\t\t\t}\n\t\t\t},\n\t\t\tresolve : {\n\t\t\t\t\"$song\" : [ \"$stateParams\", \"$templateRequest\", \"songsIndex\", function( $stateParams, $templateRequest, index ) {\n\t\t\t\t\tvar key = $stateParams.song_key, song = index[key];\n\n\t\t\t\t\tif (!song) throw \"Could not found song '\"+ key +\"'\";\n\n\t\t\t\t\treturn $templateRequest( song.$templateUrl ).then(() => song);\n\t\t\t\t}]\n\t\t\t}\n\t\t})\n\t}])\n\n\t.run([ \"$rootScope\", \"$state\", \"Songs\", function( $rootScope, $state, Songs ) {\n\t\t$rootScope.$state = $state;\n\t\t$rootScope.songsIndex = {};\n\t\t$rootScope.font_size = 12;\n\n\t\t$rootScope.setSongFont  = n => $rootScope.font_size += n;\n\t\t$rootScope.increaseFont = n => $rootScope.font_size *= 1.1;\n\t\t$rootScope.decreaseFont = n => $rootScope.font_size *= 0.9;\n\t\n\t\t$rootScope.search = \"\";\n\n\t\t$rootScope.songlist = {\n\t\t\topen : true\n\t\t};\n\n\t\twindow.addEventListener( \"resize\", $rootScope.$emit.bind( $rootScope, \"resize\" ));\n\n\t\t$rootScope.$watch( \"songlist.open\", $rootScope.$emit.bind( $rootScope, \"resize\" ));\n\n\t\t$rootScope.$on('$stateChangeStart', (event, toState, toParams, fromState, fromParams, _options)=>{\n\t\t\ttry {\n\t\t\t\tif (toState.name == \"index\")\n\t\t\t\t\t$rootScope.$song = null;\n\t\t\t} catch(err) {\n\t\t\t\tconsole.error(err);\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t});\n\n\t\t$rootScope.$on('$stateChangeError', (event, toState, toParams, fromState, fromParams)=>{\n\t\t\tconsole.error( '$stateChangeError @ '+toState.to, arguments );\n\t\t});\n\n\t\t$rootScope.$on('$stateChangeSuccess', (event, toState, toParams, fromState, fromParams)=>{\n\t\t\tconsole.log( '$stateChangeSuccess @ '+toState.to, arguments );\n\t\t\t\n\t\t\tif (toState.name == 'index') $rootScope.songlist.open = true;\n\t\n\t\t\tangular.element( document.body ).attr(\"state\", toState.name);\n\t\t});\n\n\t\t$rootScope.$on('$viewContentLoaded', event => {\n\t\t\tconsole.log('$viewContentLoaded', arguments);\n\t\t});\n\n\t\t$rootScope.$on('$stateNotFound', (event, unfoundState, fromState, fromParams) => {\n\t\t\tconsole.error('$stateNotFound @ '+unfoundState.to, arguments);\n\t\t});\n\t}])\n\n\t.service( \"Songs\", [ \"$http\", function( $http ) {\n\t\t\n\t\tvar index = this.index = {};\n\n\t\t/****************/\n\n\t\tthis.init = url => ($http({ url }).then(response => {\n\t\t\tfor (var key in response.data) {\n\t\t\t\tif (response.data[ key ].disable) continue;\n\t\t\t\tindex[ key ] = new Song( key, response.data[ key ]);\n\t\t\t}\n\t\t\t\n\t\t\tthis.sorted = Object.keys( index ).map(key => index[ key ]).sort((a, b) => (a.num - b.num));\n\n\t\t\treturn index;\n\t\t}));\n\t}])\n\n\t.controller( \"songListController\", [\"$rootScope\", \"$scope\", \"$stateParams\", \"songsIndex\", \"Songs\", function( $rootScope, $scope, $stateParams, songsIndex, Songs ) {\n\n\t\t$scope.Songs = Songs;\n\t\tvar index = songsIndex;\n\t\t$scope.songsCount = 0;\n\n\t\t$scope.runFilter = search => {\n\t\t\tvar search = $rootScope.search = (search == null ? $rootScope.search : search) || '';\n\t\t\tif (search) search = search.toLowerCase( ).trim( );\n\t\t\tif (search) search = search.split( /\\s+/g );\n\n\t\t\t$scope.songsCount = 0;\n\n\t\t\tfor (var song of Songs.sorted) {\n\t\t\t\tif (search) {\n\t\t\t\t\tsong.$$filtered = true;\n\t\t\t\t\tsearch.forEach( str => {\n\t\t\t\t\t\tif (song.$search.$string.indexOf( str ) != -1) {\n\t\t\t\t\t\t\tsong.$$filtered = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tsong.$$filtered = false;\n\t\t\t\t}\n\n\t\t\t\tif (!song.$$filtered) $scope.songsCount++;\n\t\t\t}\n\t\t};\n\n\t\tsetTimeout(() => {\n\t\t\t$scope.runFilter();\n\t\t});\n\t}])\n\n\t.controller(\"songViewController\", [\"$rootScope\", \"$scope\", \"$sce\", \"$song\", \"$timeout\", function( $rootScope, $scope, $sce, $song, $timeout ) {\n\t\tconsole.log( \"songViewController :: Loaded song \" + $song.title, $song );\n\n\t\t$scope.$song = $song;\n\n\t\tvar songBodyElem = document.getElementById(\"song-body\");\n\n\t\tif (window.innerWidth <= 768) $rootScope.songlist.open = false;\n\n\t\t$rootScope.$on( \"resize\", refreshFont );\n\n\t\t$scope.loading = refreshFont().then(() => {\n\t\t\t$scope.loading = false;\n\t\t});\n\n\t\tfunction refreshFont() {\n\t\t\treturn $timeout(function(){\n\t\t\t\tvar pre = document.getElementById( \"song-body\" );\n\t\t\t\tvar prs = pre.parentNode.offsetWidth / pre.offsetWidth;\n\t\t\t\tif (prs > 0) $rootScope.font_size *= prs;\n\t\t\t\tconsole.log( \"refreshFont() :: \", $rootScope.font_size, \"em\" );\n\t\t\t}).catch(function( e ){\n\t\t\t\tconsole.warn( \"Unable to customize font size\", e );\n\t\t\t});\n\t\t}\n\t}])\n\n\t.controller(\"songMetaController\", [\"$rootScope\", \"$scope\", \"$song\", function($rootScope, $scope, $song) {\n\t\t$scope.meta = {\n\t\t\ttitle  : $song.title,\n\t\t\tauthor : $song.author || null,\n\t\t\tlinks  : $song.links  || {},\n\t\t};\n\n\t\tfor(var title in $scope.meta.links) {\n\t\t\t$scope.meta.links[title] = {\n\t\t\t\ttitle : title,\n\t\t\t\thref  : $scope.meta.links[title]\n\t\t\t};\n\t\t}\n\t}]);\n})();\n"]}