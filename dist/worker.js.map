{"version":3,"sources":["../src/worker.js"],"names":[],"mappings":"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","file":"worker.js","sourcesContent":["(() => {\n\tclass SearchString{\n\t\tconstructor( argv ){\n\t\t\tthis.$string   = \"\";\n\t\t\tthis.$contains = {}\n\n\t\t\targv && this.extend( argv );\n\t\t}\n\n\t\textend( argv ){\n\t\t\tvar str = null;\n\t\t\tif (typeof argv == \"object\") {\n\t\t\t\tstr = \"\";\n\t\t\t\tfor (var key in argv) {\n\t\t\t\t\tif (argv[ key ] != null) {\n\t\t\t\t\t\targv[ key ] = SearchString.filterString2searchKey( argv[ key ]);\n\t\t\t\t\t\tthis.$contains[ key ] = (this.$contains[ key ] || \"\") + \" \" + argv[ key ];\n\t\t\t\t\t\tstr += \" \" + argv[ key ];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (typeof argv == \"string\" && argv.trim().length > 0 ){\n\t\t\t\tstr = argv;\n\t\t\t}\n\n\t\t\tif (typeof str == \"string\") {\n\t\t\t\tthis.$string = SearchString.filterString2searchKey( this.$string, str );\n\t\t\t} else if (argv) {\n\t\t\t\tconsole.warn( \"SearchString.extend :: Invalid argument\" );\n\t\t\t}\n\t\t}\n\n\t\ttoString() {\n\t\t\treturn this.$string;\n\t\t}\n\t}\n\n\tSearchString.filterString2searchKey = (function(){\n\t\tvar regexp_torm  = /[\\.,:'\\(\\)\\[\\]\\{\\}\\/\\\\]/g;  // Poistettavat (whitespacella korvattavat) merkit\n\t\tvar regexp_toosm = /\\s.{0,3}\\s/g;                 // Liian lyhyet whitespacen ympäröimät merkkijonot ( 0-3 merkkiä) (myös whitespacen, (2-5 merkkiä))\n\n\t\treturn function( str ) {\n\t\t\tif (arguments.length > 1) return SearchString.filterString2searchKey( Array.prototype.slice.call( arguments ));\n\t\t\tif (Array.isArray( str )) str = parseArray2string( str );\n\t\t\tif (typeof str != \"string\") return console.warn( \"SearchString.filterString2searchkey :: Invalid argument\", typeof str, str ), \"\";\n\n\t\t\treturn (\" \" + str.toLowerCase().replace( regexp_torm, \" \" ) + \" \").replace( regexp_toosm, \" \" ).trim();\n\t\t};\n\n\t\tfunction parseArray2string( arr ){\n\t\t\treturn arr.filter(function( v ) {\n\t\t\t\treturn !!v;\n\t\t\t}).map(function( v ) {\n\t\t\t\treturn Array.isArray( v ) ? parseArray2string( v ) : v;\n\t\t\t}).join(\" \");\n\t\t}\n\t})();\n\n\n\n\tangular.module(\"laulukirja-app\", [ \"ui.router\" ])\n\n\t.config([ \"$stateProvider\", \"$urlRouterProvider\", function($stateProvider, $urlRouterProvider){\n\t\t$urlRouterProvider.otherwise(\"/index\");\n\t\t$stateProvider.state(\"index\", {\n\t\t\turl        : \"/index\",\n\t\t\tviews : {\n\t\t\t\t\"songsList@\" : {\n\t\t\t\t\tcontroller  : \"songListController\",\n\t\t\t\t\ttemplateUrl : \"partials/songlist.html\"\n\t\t\t\t},\n\t\t\t\t\"songView@\" : {\n\t\t\t\t\tcontroller : [ \"$scope\", \"$timeout\", function( $scope, $timeout ){ $scope.loading = $timeout(()=>{ $scope.loading = false; }); }],\n\t\t\t\t\ttemplate: \"<h3 style='text-align:left;padding-left:1em;'><b class='glyphicon glyphicon-share-alt' style='transform:rotate(230deg);'></b> Valitse laulu laululistasta</h3>\"\n\t\t\t\t}\n\t\t\t},\n\t\t\tresolve : {\n\t\t\t\t\"songsIndex\" : [\"$rootScope\", \"$http\", function($rootScope, $http){\n\t\t\t\t\treturn $http({\n\t\t\t\t\t\turl    : \"songs/index.json\",\n\t\t\t\t\t\tmethod : \"GET\"\n\t\t\t\t\t}).then(response => {\n\t\t\t\t\t\tvar songsIndex = response.data;\n\n\t\t\t\t\t\tfor (var key in songsIndex) {\n\t\t\t\t\t\t\tif (songsIndex[key].disabled) {\n\t\t\t\t\t\t\t\tdelete songsIndex[key];\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tsongsIndex[ key ] = new Song( key, songsIndex[ key ]);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t$rootScope.songsArr = Object.keys(songsIndex);\n\t\t\t\t\t\t\n\t\t\t\t\t\t$rootScope.songsArr.sort((a, b) => (songsIndex[a].num - songsIndex[b].num));\n\t\t\t\t\t\t\n\t\t\t\t\t\treturn $rootScope.songsIndex = songsIndex;\n\t\t\t\t\t}).catch(console.error.bind(console, \"Cannot GET 'songs/index.json'\"));\n\t\t\t\t}]\n\t\t\t}\n\t\t}).state(\"index.song\", {\n\t\t\turl   : \"/:song_key\",\n\t\t\tviews : {\n\t\t\t\t\"songView@\" : {\n\t\t\t\t\tcontroller  : \"songViewController\",\n\t\t\t\t\ttemplateUrl : \"partials/songview.html\"\n\t\t\t\t},\n\t\t\t\t\"songMeta@\" : {\n\t\t\t\t\tcontroller  : \"songMetaController\",\n\t\t\t\t\ttemplateUrl : \"partials/songmeta.html\"\n\t\t\t\t}\n\t\t\t},\n\t\t\tresolve : {\n\t\t\t\t\"$songMeta\" : [\"$rootScope\", \"$http\", \"$stateParams\", \"$state\", \"songsIndex\", function($rootScope, $http, $stateParams, $state, songsIndex){\n\t\t\t\t\tif (!songsIndex[$stateParams.song_key]) {\n\t\t\t\t\t\tconsole.error(\"Could not found song '\"+ $stateParams.song_key +\"'\");\n\t\t\t\t\t\t$state.go(\"index\");\n\t\t\t\t\t}\n\t\t\t\t\treturn songsIndex[$stateParams.song_key];\n\t\t\t\t}],\n\t\t\t\t\"$songBody\" : [\"$templateRequest\", \"$rootScope\", \"$http\", \"$stateParams\", \"$state\", \"$songMeta\", function($templateRequest, $rootScope, $http, $stateParams, $state, $songMeta){\n\t\t\t\t\treturn $templateRequest( $songMeta.$templateUrl ).catch(err => {\n\t\t\t\t\t\tconsole.error( `Could not GET '${ $songMeta.$templateUrl }'`, err );\n\t\t\t\t\t\t$state.go( \"index\" );\n\t\t\t\t\t});\n\t\t\t\t}]\n\t\t\t}\n\t\t})\n\t}])\n\n\t.run([ \"$rootScope\", \"$state\", function( $rootScope, $state ) {\n\t\t$rootScope.$state = $state;\n\t\t$rootScope.songsIndex = {};\n\t\t$rootScope.font_size = 12;\n\n\t\t$rootScope.setSongFont  = n => $rootScope.font_size += n;\n\t\t$rootScope.increaseFont = n => $rootScope.font_size *= 1.1;\n\t\t$rootScope.decreaseFont = n => $rootScope.font_size *= 0.9;\n\t\n\t\t$rootScope.search = \"\";\n\n\t\t$rootScope.songlist = {\n\t\t\topen : true\n\t\t};\n\n\t\twindow.addEventListener( \"resize\", $rootScope.$emit.bind( $rootScope, \"resize\" ));\n\n\t\t$rootScope.$watch( \"songlist.open\", $rootScope.$emit.bind( $rootScope, \"resize\" ));\n\n\t\t$rootScope.$on('$stateChangeStart', (event, toState, toParams, fromState, fromParams, _options)=>{\n\t\t\ttry {\n\t\t\t\tif (toState.name == \"index\")\n\t\t\t\t\t$rootScope.$songMeta = null;\n\t\t\t} catch(err) {\n\t\t\t\tconsole.error(err);\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t});\n\n\t\t$rootScope.$on('$stateChangeError', (event, toState, toParams, fromState, fromParams)=>{\n\t\t\tconsole.error( '$stateChangeError @ '+toState.to, arguments );\n\t\t});\n\n\t\t$rootScope.$on('$stateChangeSuccess', (event, toState, toParams, fromState, fromParams)=>{\n\t\t\tconsole.log( '$stateChangeSuccess @ '+toState.to, arguments );\n\t\t\t\n\t\t\tif (toState.name == 'index') $rootScope.songlist.open = true;\n\t\n\t\t\tangular.element( document.body ).attr(\"state\", toState.name);\n\t\t});\n\n\t\t$rootScope.$on('$viewContentLoaded', event => {\n\t\t\tconsole.log('$viewContentLoaded', arguments);\n\t\t});\n\n\t\t$rootScope.$on('$stateNotFound', (event, unfoundState, fromState, fromParams) => {\n\t\t\tconsole.error('$stateNotFound @ '+unfoundState.to, arguments);\n\t\t});\n\t}])\n\n\t.controller(\"songListController\", [\"$rootScope\", \"$scope\", \"$stateParams\", \"songsIndex\", function( $rootScope, $scope, $stateParams, songsIndex ) {\n\t\t$scope.$stateParams = $stateParams;\n\n\t\t$scope.songs = songsIndex;\n\t\t$scope.songsCount = 0;\n\n\t\t$scope.runFilter = search => {\n\t\t\tvar search = $rootScope.search = (search == null ? $rootScope.search : search) || '';\n\t\t\tif (search) search = search.toLowerCase( ).trim( );\n\t\t\tif (search) search = search.split( /\\s+/g );\n\n\t\t\t$scope.songsCount = 0;\n\n\t\t\tfor (var key in songsIndex) {\n\t\t\t\tif (search) {\n\t\t\t\t\tsongsIndex[ key ].$$filtered = true;\n\t\t\t\t\tsearch.forEach( str => {\n\t\t\t\t\t\tif (songsIndex[ key ].$search.$string.indexOf( str ) != -1) {\n\t\t\t\t\t\t\tsongsIndex[ key ].$$filtered = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tsongsIndex[ key ].$$filtered = false;\n\t\t\t\t}\n\n\t\t\t\tif (!songsIndex[ key ].$$filtered) $scope.songsCount++;\n\t\t\t}\n\t\t};\n\n\t\tsetTimeout(() => {\n\t\t\t$scope.runFilter();\n\t\t});\n\n\t\tconsole.log(songsIndex);\n\t}])\n\n\t.controller(\"songViewController\", [\"$rootScope\", \"$scope\", \"$sce\", \"songsIndex\", \"$songMeta\", \"$songBody\", \"$timeout\", function( $rootScope, $scope, $sce, songsIndex, $songMeta, $songBody, $timeout ) {\n\t\tconsole.log( \"songViewController :: Loaded song \" + $songMeta.title, $songMeta );\n\n\t\t$scope.$songMeta = $songMeta;\n\t\t$scope.$songBody = $songBody;\n\n\t\tvar songBodyElem = document.getElementById(\"song-body\");\n\n\t\tif (window.innerWidth <= 768) $rootScope.songlist.open = false;\n\n\t\t$rootScope.$on( \"resize\", refreshFont );\n\n\t\t$scope.loading = refreshFont().then(() => {\n\t\t\t$scope.loading = false;\n\t\t});\n\n\t\tfunction refreshFont() {\n\t\t\treturn $timeout(function(){\n\t\t\t\tvar pre = document.getElementById( \"song-body\" );\n\t\t\t\tvar prs = pre.parentNode.offsetWidth / pre.offsetWidth;\n\t\t\t\tif (prs > 0) $rootScope.font_size *= prs;\n\t\t\t\tconsole.log( \"refreshFont() :: \", $rootScope.font_size, \"em\" );\n\t\t\t}).catch(function( e ){\n\t\t\t\tconsole.warn( \"Unable to customize font size\", e );\n\t\t\t});\n\t\t}\n\t}])\n\n\t.controller(\"songMetaController\", [\"$rootScope\", \"$scope\", \"songsIndex\", \"$songBody\", \"$songMeta\", function($rootScope, $scope, songsIndex, $songBody, $songMeta) {\n\t\t$scope.meta = {\n\t\t\ttitle  : $songMeta.title,\n\t\t\tauthor : $songMeta.author || null,\n\t\t\tlinks  : $songMeta.links  || {},\n\t\t};\n\n\t\tfor(var title in $scope.meta.links) {\n\t\t\t$scope.meta.links[title] = {\n\t\t\t\ttitle : title,\n\t\t\t\thref  : $scope.meta.links[title]\n\t\t\t};\n\t\t}\n\t}])\n\n\t.component(\"a_songList\", {\n\t\ttemplate : \"partials/songlist.html\",\n\t\tcontroller : [\"$scope\", \"$rootScope\", function($scope, $rootScope){\n\t\t\tconsole.log($rootScope.songsIndex);\n\t\t}]\n\t});\n\n\n\n\tclass Song {\n\t\tconstructor( key, data ) {\n\t\t\tthis.key = key;\n\t\t\tfor (var v in data) this[ v ] = data[ v ];\n\n\t\t\tthis.$templateUrl = `songs/${ key }/song.html`;\n\n\t\t\tthis.$search = new SearchString({\n\t\t\t\ttitle : data.title || \"\",\n\t\t\t\tnum   : data.num == null ? \"\" : data.num.toString().trim()\n\t\t\t});\n\t\t}\n\t}\n})();\n"]}