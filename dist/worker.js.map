{"version":3,"sources":["../src/worker.js"],"names":[],"mappings":"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","file":"worker.js","sourcesContent":["window.LaulukirjaApp = angular.module(\"laulukirja-app\", [ \"ui.router\" ]);\n\nLaulukirjaApp.config([ \"$stateProvider\", \"$urlRouterProvider\", function($stateProvider, $urlRouterProvider){\n\t$urlRouterProvider.otherwise(\"/index\");\n\t$stateProvider.state(\"index\", {\n\t\turl        : \"/index\",\n\t\tviews : {\n\t\t\t\"songsList@\" : {\n\t\t\t\tcontroller  : \"songListController\",\n\t\t\t\ttemplateUrl : \"partials/songlist.html\"\n\t\t\t}\n\t\t},\n\t\tresolve : {\n\t\t\t\"songsIndex\" : [\"$rootScope\", \"$http\", function($rootScope, $http){\n\t\t\t\treturn $http({\n\t\t\t\t\turl    : \"songs/index.json\",\n\t\t\t\t\tmethod : \"GET\"\n\t\t\t\t}).then(response => {\n\t\t\t\t\tvar songsIndex = response.data;\n\t\t\t\t\tfor(var key in songsIndex) {\n\t\t\t\t\t\tif (songsIndex[key].disabled) {\n\t\t\t\t\t\t\tdelete songsIndex[key];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tsongsIndex[key].key = key;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t$rootScope.songsArr = Object.keys(songsIndex);\n\t\t\t\t\t$rootScope.songsArr.sort((a, b) => {\n\t\t\t\t\t\treturn songsIndex[a].num - songsIndex[b].num;\n\t\t\t\t\t});\n\t\t\t\t\treturn $rootScope.songsIndex = songsIndex;\n\t\t\t\t}).catch(console.error.bind(console, \"Cannot GET 'songs/index.json'\"));\n\t\t\t}]\n\t\t}\n\t}).state(\"index.song\", {\n\t\turl   : \"/:song_key\",\n\t\tviews : {\n\t\t\t\"songView@\" : {\n\t\t\t\tcontroller  : \"songViewController\",\n\t\t\t\ttemplateUrl : \"partials/songview.html\"\n\t\t\t},\n\t\t\t\"songMeta@\" : {\n\t\t\t\tcontroller  : \"songMetaController\",\n\t\t\t\ttemplateUrl : \"partials/songmeta.html\"\n\t\t\t}\n\t\t},\n\t\tresolve : {\n\t\t\t\"$songMeta\" : [\"$rootScope\", \"$http\", \"$stateParams\", \"$state\", \"songsIndex\", function($rootScope, $http, $stateParams, $state, songsIndex){\n\t\t\t\tif (!songsIndex[$stateParams.song_key]) {\n\t\t\t\t\tconsole.error(\"Could not found song '\"+ $stateParams.song_key +\"'\");\n\t\t\t\t\t$state.go(\"index\");\n\t\t\t\t}\n\t\t\t\treturn songsIndex[$stateParams.song_key];\n\t\t\t}],\n\t\t\t\"$songBody\" : [\"$rootScope\", \"$http\", \"$stateParams\", \"$state\", \"$songMeta\", function($rootScope, $http, $stateParams, $state, $songMeta){\n\t\t\t\treturn $http({\n\t\t\t\t\turl    : \"songs/\"+ $songMeta.key +\"/song.html\",\n\t\t\t\t\tmethod : \"GET\"\n\t\t\t\t}).then(response => {\n\t\t\t\t\t$rootScope.$songMeta = $songMeta;\n\t\t\t\t\treturn response.data;\n\t\t\t\t}).catch(err => {\n\t\t\t\t\tconsole.error( \"Could not GET 'songs/\"+ $songMeta.key +\"/song.html'\", err );\n\t\t\t\t\t$state.go( \"index\" );\n\t\t\t\t});\n\t\t\t}]\n\t\t}\n\t})\n}]);\nLaulukirjaApp.run([ \"$rootScope\", \"$state\", function($rootScope, $state) {\n\t$rootScope.$state = $state;\n\t$rootScope.songsIndex = {};\n\t$rootScope.font_size = 12;\n\n\t$rootScope.setSongFont  = n => $rootScope.font_size += n;\n\t$rootScope.increaseFont = n => $rootScope.font_size *= 1.1;\n\t$rootScope.decreaseFont = n => $rootScope.font_size *= 0.9;\n\n\t$rootScope.songlist = {\n\t\topen : true\n\t};\n\n\twindow.addEventListener( \"resize\", $rootScope.$emit.bind( $rootScope, \"resize\" ));\n\n\t$rootScope.$watch( \"songlist.open\", $rootScope.$emit.bind( $rootScope, \"resize\" ));\n\n\t$rootScope.$on('$stateChangeStart', (event, toState, toParams, fromState, fromParams, _options)=>{\n\t\ttry {\n\t\t\tif (toState.name == \"index\")\n\t\t\t\t$rootScope.$songMeta = null;\n\t\t} catch(err) {\n\t\t\tconsole.error(err);\n\t\t\tevent.preventDefault();\n\t\t}\n\t});\n\n\t$rootScope.$on('$stateChangeError', (event, toState, toParams, fromState, fromParams)=>{\n\t\tconsole.error('$stateChangeError @ '+toState.to, arguments);\n\t});\n\n\t$rootScope.$on('$stateChangeSuccess', (event, toState, toParams, fromState, fromParams)=>{\n\t\tconsole.log('$stateChangeSuccess @ '+toState.to, arguments);\n\t\tif (toState.name == 'index') $rootScope.songlist.open = true;\n\t\telse if (toState.name == 'index.song') {\n\t\t\tif (window.innerWidth <= 768) $rootScope.songlist.open = false;\n\t\t}\n\t\tangular.element(document.body).attr(\"state\", toState.name);\n\t});\n\n\t$rootScope.$on('$viewContentLoaded', event => {\n\t\tconsole.log('$viewContentLoaded', arguments);\n\t});\n\n\t$rootScope.$on('$stateNotFound', (event, unfoundState, fromState, fromParams) => {\n\t\tconsole.error('$stateNotFound @ '+unfoundState.to, arguments);\n\t});\n}]);\n\nLaulukirjaApp.controller(\"songListController\", [\"$rootScope\", \"$scope\", \"$stateParams\", \"songsIndex\", function($rootScope, $scope, $stateParams, songsIndex){\n\t$scope.$stateParams = $stateParams;\n\tconsole.log(songsIndex);\n}]);\nLaulukirjaApp.controller(\"songViewController\", [\"$rootScope\", \"$scope\", \"$sce\", \"songsIndex\", \"$songMeta\", \"$songBody\", \"$timeout\", function( $rootScope, $scope, $sce, songsIndex, $songMeta, $songBody, $timeout ) {\n\tvar scrollStalker;\n\n\t$scope.$songMeta = $songMeta;\n\t$scope.$songBody = $songBody;\n\n\tvar songBodyElem = document.getElementById(\"song-body\");\n\tsongBodyElem.innerHTML = $songBody;\n\n\t$rootScope.$on( \"resize\", refreshFont );\n\n\t$scope.loading = refreshFont().then(() => {\n\t\t$scope.loading = false;\n\t});\n\n\tfunction refreshFont() {\n\t\treturn $timeout(function(){\n\t\t\tvar pre = document.getElementById( \"song-body\" );\n\t\t\tvar prs = pre.parentNode.offsetWidth / pre.offsetWidth;\n\t\t\tif (prs > 0) $rootScope.font_size *= prs;\n\t\t\tconsole.log( \"refreshFont() :: \", $rootScope.font_size, \"em\" );\n\t\t}).catch(function( e ){\n\t\t\tconsole.warn( \"Unable to customize font size\", e );\n\t\t});\n\t}\n}]);\nLaulukirjaApp.controller(\"songMetaController\", [\"$rootScope\", \"$scope\", \"songsIndex\", \"$songBody\", \"$songMeta\", function($rootScope, $scope, songsIndex, $songBody, $songMeta) {\n//\tconsole.log(songsIndex, $songBody, $songMeta);\n\t$scope.meta = {\n\t\ttitle  : $songMeta.title,\n\t\tauthor : $songMeta.author || null,\n\t\tlinks  : $songMeta.links  || {},\n\t}\n\tfor(var title in $scope.meta.links) {\n\t\t$scope.meta.links[title] = {\n\t\t\ttitle : title,\n\t\t\thref  : $scope.meta.links[title]\n\t\t};\n\t}\n}]);\n\n\nLaulukirjaApp.component(\"a_songList\", {\n\ttemplate : \"partials/songlist.html\",\n\tcontroller : [\"$scope\", \"$rootScope\", function($scope, $rootScope){\n\t\tconsole.log($rootScope.songsIndex);\n\t}]\n})\n"]}