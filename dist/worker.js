"use strict";window.LaulukirjaApp=angular.module("laulukirja-app",["ui.router"]),LaulukirjaApp.config(["$stateProvider","$urlRouterProvider",function(a,b){b.otherwise("/index"),a.state("index",{url:"/index",views:{"songsList@":{controller:"songListController",templateUrl:"partials/songlist.html"}},resolve:{songsIndex:["$rootScope","$http",function(a,b){return b({url:"songs/index.json",method:"GET"}).then(function(b){var c=b.data;for(var d in c)c[d].disabled?delete c[d]:c[d].key=d;return a.songsArr=Object.keys(c),a.songsArr.sort(function(d,a){return c[d].num-c[a].num}),a.songsIndex=c})["catch"](console.error.bind(console,"Cannot GET 'songs/index.json'"))}]}}).state("index.song",{url:"/:song_key",views:{"songView@":{controller:"songViewController",templateUrl:"partials/songview.html"},"songMeta@":{controller:"songMetaController",templateUrl:"partials/songmeta.html"}},resolve:{$songMeta:["$rootScope","$http","$stateParams","$state","songsIndex",function(a,b,c,d,e){return e[c.song_key]||(console.error("Could not found song '"+c.song_key+"'"),d.go("index")),e[c.song_key]}],$songBody:["$rootScope","$http","$stateParams","$state","$songMeta",function(a,b,c,d,e){return b({url:"songs/"+e.key+"/song.html",method:"GET"}).then(function(b){return a.$songMeta=e,b.data})["catch"](function(a){console.error("Could not GET 'songs/"+e.key+"/song.html'",a),d.go("index")})}]}})}]),LaulukirjaApp.run(["$rootScope","$state",function(a,b){var c=arguments;a.$state=b,a.songsIndex={},a.font_size=12,a.setSongFont=function(b){return a.font_size+=b},a.increaseFont=function(){return a.font_size*=1.1},a.decreaseFont=function(){return a.font_size*=.9},a.songlist={open:!0},window.addEventListener("resize",a.$emit.bind(a,"resize")),a.$watch("songlist.open",a.$emit.bind(a,"resize")),a.$on("$stateChangeStart",function(b,c){try{"index"==c.name&&(a.$songMeta=null)}catch(a){console.error(a),b.preventDefault()}}),a.$on("$stateChangeError",function(a,b){console.error("$stateChangeError @ "+b.to,c)}),a.$on("$stateChangeSuccess",function(b,d){console.log("$stateChangeSuccess @ "+d.to,c),"index"==d.name?a.songlist.open=!0:"index.song"==d.name&&768>=window.innerWidth&&(a.songlist.open=!1),angular.element(document.body).attr("state",d.name)}),a.$on("$viewContentLoaded",function(){console.log("$viewContentLoaded",c)}),a.$on("$stateNotFound",function(a,b){console.error("$stateNotFound @ "+b.to,c)})}]),LaulukirjaApp.controller("songListController",["$rootScope","$scope","$stateParams","songsIndex",function(a,b,c,d){b.$stateParams=c,console.log(d)}]),LaulukirjaApp.controller("songViewController",["$rootScope","$scope","$sce","songsIndex","$songMeta","$songBody","$timeout",function(a,b,c,d,e,f,g){function h(){return g(function(){var b=document.getElementById("song-body"),c=b.parentNode.offsetWidth/b.offsetWidth;0<c&&(a.font_size*=c),console.log("refreshFont() :: ",a.font_size,"em")})["catch"](function(a){console.warn("Unable to customize font size",a)})}b.$songMeta=e,b.$songBody=f;var i=document.getElementById("song-body");i.innerHTML=f,a.$on("resize",h),b.loading=h().then(function(){b.loading=!1})}]),LaulukirjaApp.controller("songMetaController",["$rootScope","$scope","songsIndex","$songBody","$songMeta",function(a,b,c,d,e){for(var f in b.meta={title:e.title,author:e.author||null,links:e.links||{}},b.meta.links)b.meta.links[f]={title:f,href:b.meta.links[f]}}]),LaulukirjaApp.component("a_songList",{template:"partials/songlist.html",controller:["$scope","$rootScope",function(a,b){console.log(b.songsIndex)}]});

//# sourceMappingURL=worker.js.map