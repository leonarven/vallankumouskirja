"use strict";function _typeof(a){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof(a)}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(function(){var a=function a(c,d){for(var e in _classCallCheck(this,a),this.key=c,d)this[e]=d[e];this.$templateUrl="songs/".concat(c,"/song.html"),this.$search=new b({title:d.title||"",num:null==d.num?"":d.num.toString().trim()})},b=/*#__PURE__*/function(){function a(b){_classCallCheck(this,a),this.$string="",this.$contains={},b&&this.extend(b)}return _createClass(a,[{key:"extend",value:function extend(b){var c=null;if("object"==_typeof(b))for(var d in c="",b)null!=b[d]&&(b[d]=a.filterString2searchKey(b[d]),this.$contains[d]=(this.$contains[d]||"")+" "+b[d],c+=" "+b[d]);else"string"==typeof b&&0<b.trim().length&&(c=b);"string"==typeof c?this.$string=a.filterString2searchKey(this.$string,c):b&&console.warn("SearchString.extend :: Invalid argument")}},{key:"toString",value:function toString(){return this.$string}}]),a}();/************************************************************/b.filterString2searchKey=function(){function a(b){return b.filter(function(a){return!!a}).map(function(b){return Array.isArray(b)?a(b):b}).join(" ")}var c=/[\.,:'\(\)\[\]\{\}\/\\]/g,d=/\s.{0,3}\s/g;// Poistettavat (whitespacella korvattavat) merkit
// Liian lyhyet whitespacen ympäröimät merkkijonot ( 0-3 merkkiä) (myös whitespacen, (2-5 merkkiä))
return function(e){return 1<arguments.length?b.filterString2searchKey(Array.prototype.slice.call(arguments)):(Array.isArray(e)&&(e=a(e)),"string"==typeof e?(" "+e.toLowerCase().replace(c," ")+" ").replace(d," ").trim():(console.warn("SearchString.filterString2searchkey :: Invalid argument",_typeof(e),e),""))}}(),angular.module("laulukirja-app",["ui.router"]).config(["$stateProvider","$urlRouterProvider",function(a,b){b.otherwise("/index"),a.state("index",{url:"/index",views:{"songsList@":{controller:"songListController",templateUrl:"partials/songlist.html"},"songView@":{controller:["$scope","$timeout",function(a,b){a.loading=b(function(){a.loading=!1})}],template:"<h3 style='text-align:left;padding-left:1em;'><b class='glyphicon glyphicon-share-alt' style='transform:rotate(230deg);'></b> Valitse laulu laululistasta</h3>"}},resolve:{songsIndex:["Songs",function(a){return a.init("songs/index.json")}]}}).state("index.song",{url:"/:song_key",views:{"songView@":{controller:"songViewController",templateUrl:"partials/songview.html"},"songMeta@":{controller:"songMetaController",templateUrl:"partials/songmeta.html"}},resolve:{$song:["$stateParams","$templateRequest","songsIndex",function(a,b,c){var d=a.song_key,e=c[d];if(!e)throw"Could not found song '"+d+"'";return b(e.$templateUrl).then(function(){return e})}]}})}]).run(["$rootScope","$state","Songs",function(a,b){var c=arguments;a.$state=b,a.songsIndex={},a.font_size=12,a.setSongFont=function(b){return a.font_size+=b},a.increaseFont=function(){return a.font_size*=1.1},a.decreaseFont=function(){return a.font_size*=.9},a.search="",a.songlist={open:!0},window.addEventListener("resize",a.$emit.bind(a,"resize")),a.$watch("songlist.open",a.$emit.bind(a,"resize")),a.$on("$stateChangeStart",function(b,c){try{"index"==c.name&&(a.$song=null)}catch(a){console.error(a),b.preventDefault()}}),a.$on("$stateChangeError",function(a,b){console.error("$stateChangeError @ "+b.to,c)}),a.$on("$stateChangeSuccess",function(b,d){console.log("$stateChangeSuccess @ "+d.to,c),"index"==d.name&&(a.songlist.open=!0),angular.element(document.body).attr("state",d.name)}),a.$on("$viewContentLoaded",function(){console.log("$viewContentLoaded",c)}),a.$on("$stateNotFound",function(a,b){console.error("$stateNotFound @ "+b.to,c)})}]).service("Songs",["$http",function(b){var c=this,d=this.index={};/****************/this.init=function(e){return b({url:e}).then(function(b){for(var e in b.data)b.data[e].disable||(d[e]=new a(e,b.data[e]));return c.sorted=Object.keys(d).map(function(a){return d[a]}).sort(function(c,a){return c.num-a.num}),d})}}]).controller("songListController",["$rootScope","$scope","$stateParams","songsIndex","Songs",function(a,b,c,d,e){b.Songs=e;b.songsCount=0,b.runFilter=function(c){var c=a.search=(null==c?a.search:c)||"";c&&(c=c.toLowerCase().trim()),c&&(c=c.split(/\s+/g)),b.songsCount=0;var d=!0,f=!1,g=void 0;try{for(var h,i,j=e.sorted[Symbol.iterator]();!(d=(h=j.next()).done);d=!0)i=h.value,c?(i.$$filtered=!0,c.forEach(function(a){-1!=i.$search.$string.indexOf(a)&&(i.$$filtered=!1)})):i.$$filtered=!1,i.$$filtered||b.songsCount++}catch(a){f=!0,g=a}finally{try{d||null==j["return"]||j["return"]()}finally{if(f)throw g}}},setTimeout(function(){b.runFilter()})}]).controller("songViewController",["$rootScope","$scope","$sce","$song","$timeout",function(a,b,c,d,e){function f(){return e(function(){var b=document.getElementById("song-body"),c=b.parentNode.offsetWidth/b.offsetWidth;0<c&&(a.font_size*=c),console.log("refreshFont() :: ",a.font_size,"em")})["catch"](function(a){console.warn("Unable to customize font size",a)})}console.log("songViewController :: Loaded song "+d.title,d),b.$song=d;document.getElementById("song-body");768>=window.innerWidth&&(a.songlist.open=!1),a.$on("resize",f),b.loading=f().then(function(){b.loading=!1})}]).controller("songMetaController",["$rootScope","$scope","$song",function(a,b,c){for(var d in b.meta={title:c.title,author:c.author||null,links:c.links||{}},b.meta.links)b.meta.links[d]={title:d,href:b.meta.links[d]}}])})();

//# sourceMappingURL=worker.js.map