"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(function(){angular.module("laulukirja-app",["ui.router"]).config(["$stateProvider","$urlRouterProvider",function(b,c){c.otherwise("/index"),b.state("index",{url:"/index",views:{"songsList@":{controller:"songListController",templateUrl:"partials/songlist.html"}},resolve:{songsIndex:["$rootScope","$http",function(b,c){return c({url:"songs/index.json",method:"GET"}).then(function(c){var d=c.data;for(var e in d){if(d[e].disabled){delete d[e];continue}d[e]=new a(e,d[e])}return b.songsArr=Object.keys(d),b.songsArr.sort(function(c,a){return d[c].num-d[a].num}),b.songsIndex=d})["catch"](console.error.bind(console,"Cannot GET 'songs/index.json'"))}]}}).state("index.song",{url:"/:song_key",views:{"songView@":{controller:"songViewController",templateUrl:"partials/songview.html"},"songMeta@":{controller:"songMetaController",templateUrl:"partials/songmeta.html"}},resolve:{$songMeta:["$rootScope","$http","$stateParams","$state","songsIndex",function(a,b,c,d,e){return e[c.song_key]||(console.error("Could not found song '"+c.song_key+"'"),d.go("index")),e[c.song_key]}],$songBody:["$rootScope","$http","$stateParams","$state","$songMeta",function(a,b,c,d,e){return b({url:"songs/"+e.key+"/song.html",method:"GET"}).then(function(b){return a.$songMeta=e,b.data})["catch"](function(a){console.error("Could not GET 'songs/"+e.key+"/song.html'",a),d.go("index")})}]}})}]).run(["$rootScope","$state",function(a,b){var c=arguments;a.$state=b,a.songsIndex={},a.font_size=12,a.setSongFont=function(b){return a.font_size+=b},a.increaseFont=function(){return a.font_size*=1.1},a.decreaseFont=function(){return a.font_size*=.9},a.search="",a.songlist={open:!0},window.addEventListener("resize",a.$emit.bind(a,"resize")),a.$watch("songlist.open",a.$emit.bind(a,"resize")),a.$on("$stateChangeStart",function(b,c){try{"index"==c.name&&(a.$songMeta=null)}catch(a){console.error(a),b.preventDefault()}}),a.$on("$stateChangeError",function(a,b){console.error("$stateChangeError @ "+b.to,c)}),a.$on("$stateChangeSuccess",function(b,d){console.log("$stateChangeSuccess @ "+d.to,c),"index"==d.name&&(a.songlist.open=!0),angular.element(document.body).attr("state",d.name)}),a.$on("$viewContentLoaded",function(){console.log("$viewContentLoaded",c)}),a.$on("$stateNotFound",function(a,b){console.error("$stateNotFound @ "+b.to,c)})}]).controller("songListController",["$rootScope","$scope","$stateParams","songsIndex",function(a,b,c,d){b.$stateParams=c,b.songs=d,b.songsCount=0,b.runFilter=function(c){var c=a.search=(null==c?a.search:c)||"";for(var e in c&&(c=c.toLowerCase().trim()),c&&(c=c.split(/\s+/g)),b.songsCount=0,d)c?(d[e].$$filtered=!0,c.forEach(function(a){-1!=d[e].$search.indexOf(a)&&(d[e].$$filtered=!1)})):d[e].$$filtered=!1,d[e].$$filtered||b.songsCount++},setTimeout(function(){b.runFilter()}),console.log(d)}]).controller("songViewController",["$rootScope","$scope","$sce","songsIndex","$songMeta","$songBody","$timeout",function(a,b,c,d,e,f,g){function h(){return g(function(){var b=document.getElementById("song-body"),c=b.parentNode.offsetWidth/b.offsetWidth;0<c&&(a.font_size*=c),console.log("refreshFont() :: ",a.font_size,"em")})["catch"](function(a){console.warn("Unable to customize font size",a)})}b.$songMeta=e,b.$songBody=f;var i=document.getElementById("song-body");i.innerHTML=f,768>=window.innerWidth&&(a.songlist.open=!1),a.$on("resize",h),b.loading=h().then(function(){b.loading=!1})}]).controller("songMetaController",["$rootScope","$scope","songsIndex","$songBody","$songMeta",function(a,b,c,d,e){for(var f in b.meta={title:e.title,author:e.author||null,links:e.links||{}},b.meta.links)b.meta.links[f]={title:f,href:b.meta.links[f]}}]).component("a_songList",{template:"partials/songlist.html",controller:["$scope","$rootScope",function(a,b){console.log(b.songsIndex)}]});var a=function a(b,c){for(var d in _classCallCheck(this,a),this.key=b,c)this[d]=c[d];this.$search=this.title.toLowerCase()}})();

//# sourceMappingURL=worker.js.map